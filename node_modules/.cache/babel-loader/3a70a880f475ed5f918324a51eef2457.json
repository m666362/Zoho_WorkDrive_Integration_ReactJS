{"ast":null,"code":"var _jsxFileName = \"D:\\\\Rayhan\\\\Unique Project\\\\zoho_api_axios(1)\\\\src\\\\App.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from \"react\";\nimport \"react-perfect-scrollbar/dist/css/styles.css\";\nimport { BuildTheme } from \"./assets/global/Theme-variable\";\nimport Response from \"./components/Playground/Response\";\nimport \"./App.css\";\nimport { makeStyles } from \"@mui/styles\";\nimport Backdrop from \"@mui/material/Backdrop\";\nimport CircularProgress from \"@mui/material/CircularProgress\";\nimport useTrackedStore from \"./store/useTrackedStore\";\nimport CryptoJS from \"crypto-js\";\nimport * as ApiCall from \"./components/Playground/api/ApiCalling\";\nimport axios from \"axios\";\nimport Tabs from \"@mui/material/Tabs\";\nimport Tab from \"@mui/material/Tab\";\nimport PropTypes from \"prop-types\";\nimport Typography from \"@mui/material/Typography\";\nimport Box from \"@mui/material/Box\";\nimport TabPanel from \"./components/Playground/TabPanel\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ZOHO = window.ZOHO;\nconst useStyles = makeStyles({\n  grid: {\n    border: \"1px solid black\"\n  },\n  icon: {\n    fontSize: \"30px !important\"\n  }\n});\n\nfunction converConncectionMap(connMap) {\n  return {\n    clientId: connMap === null || connMap === void 0 ? void 0 : connMap.client_id,\n    clientSecret: connMap === null || connMap === void 0 ? void 0 : connMap.client_secret,\n    authUrl: connMap === null || connMap === void 0 ? void 0 : connMap.auth_url,\n    refreshUrl: connMap === null || connMap === void 0 ? void 0 : connMap.refresh_url,\n    refreshToken: connMap === null || connMap === void 0 ? void 0 : connMap.refresh_token,\n    token_type: connMap === null || connMap === void 0 ? void 0 : connMap.token_type,\n    connName: connMap === null || connMap === void 0 ? void 0 : connMap.conn_name,\n    orgId: connMap === null || connMap === void 0 ? void 0 : connMap.org_id,\n    apiKey: connMap === null || connMap === void 0 ? void 0 : connMap.api_key\n  };\n}\n\nfunction a11yProps(index) {\n  return {\n    id: `simple-tab-${index}`,\n    \"aria-controls\": `simple-tabpanel-${index}`\n  };\n}\n\nconst App = () => {\n  _s();\n\n  var _stateSettings$map, _stateSettings$map2;\n\n  const classes = useStyles();\n  const state = useTrackedStore();\n  const [entity, setEntity] = useState(\"\");\n  const [entityId, setEntityId] = useState(\"\");\n  const [zohoLoaded, setZohoLoaded] = useState(false);\n  const [rootFolderId, setRootFolderId] = useState(null);\n  const [userAccessToken, setUserAccessToken] = useState(null);\n  const [value, setValue] = React.useState(0);\n  const [stateSettings, setStateSettings] = useState([]);\n\n  const handleChange = (event, newValue) => {\n    setValue(newValue);\n  };\n\n  const setUserDriveData = settings => {\n    var _settings$data;\n\n    let userDriveData = [];\n    settings === null || settings === void 0 ? void 0 : (_settings$data = settings.data) === null || _settings$data === void 0 ? void 0 : _settings$data.forEach(setting => {});\n  };\n\n  useEffect(() => {\n    /*\r\n     * Subscribe to the EmbeddedApp onPageLoad event before initializing\r\n     */\n    ZOHO.embeddedApp.on(\"PageLoad\", function (data) {\n      console.log(\"Module Data \", data);\n      setEntity(data === null || data === void 0 ? void 0 : data.Entity);\n      setEntityId(data === null || data === void 0 ? void 0 : data.EntityId);\n      setZohoLoaded(true); //Custom Bussiness logic goes here\n    });\n    /*\r\n     * initializing the widget.\r\n     */\n\n    ZOHO.embeddedApp.init();\n  }, []);\n  useEffect(async () => {\n    if (zohoLoaded && entity !== \"\" && entityId !== \"\") {\n      var _settings$data2, _settingSchema$zoho_w, _settingSchema$conn_n, _settingSchema$conn_n2, _accessTokenMap$data, _accessTokenMap$data$, _accessTokenMap$data2, _accessTokenMap$data3, _accessTokenMap$data4, _accessTokenMap$data5, _accessTokenMap$data6, _accessTokenMap$data7;\n\n      const settings = await ZOHO.CRM.API.searchRecord({\n        Entity: \"zworkflows__ZWorkFlow_Settings\",\n        Type: \"criteria\",\n        Query: \"(((zworkflows__Service_Type:equals:'ZOHO Workdrive') and (zworkflows__Settings_Type:equals:Addon)) and (zworkflows__Module_Name:equals:\" + entity + \" ))\"\n      });\n      console.log(\"settings\", settings === null || settings === void 0 ? void 0 : settings.data);\n      setStateSettings(settings === null || settings === void 0 ? void 0 : settings.data);\n      const setting1 = settings === null || settings === void 0 ? void 0 : (_settings$data2 = settings.data) === null || _settings$data2 === void 0 ? void 0 : _settings$data2[2];\n      const encSchema = setting1 === null || setting1 === void 0 ? void 0 : setting1.zworkflows__Setting_Schema_Frontend;\n      console.log({\n        encSchema\n      }, entityId);\n      const bytes = CryptoJS.AES.decrypt(encSchema, setting1 === null || setting1 === void 0 ? void 0 : setting1.id);\n      console.log({\n        bytes\n      });\n      var originalText = bytes.toString(CryptoJS.enc.Utf8);\n      const settingSchema = JSON.parse(originalText);\n      console.log({\n        settingSchema: settingSchema === null || settingSchema === void 0 ? void 0 : (_settingSchema$zoho_w = settingSchema.zoho_workdrive__crm_field_for_folder_id) === null || _settingSchema$zoho_w === void 0 ? void 0 : _settingSchema$zoho_w.api_name\n      });\n      const connSchemaStr = CryptoJS.AES.decrypt(settingSchema === null || settingSchema === void 0 ? void 0 : (_settingSchema$conn_n = settingSchema.conn_name) === null || _settingSchema$conn_n === void 0 ? void 0 : _settingSchema$conn_n.zworkflows__Connection_Settings_Frontend, settingSchema === null || settingSchema === void 0 ? void 0 : (_settingSchema$conn_n2 = settingSchema.conn_name) === null || _settingSchema$conn_n2 === void 0 ? void 0 : _settingSchema$conn_n2.id).toString(CryptoJS.enc.Utf8);\n      console.log(JSON.parse(connSchemaStr));\n      const connMap = JSON.parse(connSchemaStr);\n      console.log({\n        connMap\n      });\n      const accessokenUrl = \"https://instafunctions-695631012.development.catalystserverless.com/server/v1/auth/tokens/accesstoken\";\n      const accessTokenMap = await axios.post(accessokenUrl, converConncectionMap(connMap));\n      console.log({\n        accessTokenMap: accessTokenMap === null || accessTokenMap === void 0 ? void 0 : (_accessTokenMap$data = accessTokenMap.data) === null || _accessTokenMap$data === void 0 ? void 0 : (_accessTokenMap$data$ = _accessTokenMap$data.data) === null || _accessTokenMap$data$ === void 0 ? void 0 : _accessTokenMap$data$.token\n      });\n      const userToken = accessTokenMap === null || accessTokenMap === void 0 ? void 0 : (_accessTokenMap$data2 = accessTokenMap.data) === null || _accessTokenMap$data2 === void 0 ? void 0 : (_accessTokenMap$data3 = _accessTokenMap$data2.data) === null || _accessTokenMap$data3 === void 0 ? void 0 : _accessTokenMap$data3.token;\n      setUserAccessToken(accessTokenMap === null || accessTokenMap === void 0 ? void 0 : (_accessTokenMap$data4 = accessTokenMap.data) === null || _accessTokenMap$data4 === void 0 ? void 0 : (_accessTokenMap$data5 = _accessTokenMap$data4.data) === null || _accessTokenMap$data5 === void 0 ? void 0 : _accessTokenMap$data5.token);\n      state.setToken(accessTokenMap === null || accessTokenMap === void 0 ? void 0 : (_accessTokenMap$data6 = accessTokenMap.data) === null || _accessTokenMap$data6 === void 0 ? void 0 : (_accessTokenMap$data7 = _accessTokenMap$data6.data) === null || _accessTokenMap$data7 === void 0 ? void 0 : _accessTokenMap$data7.token);\n      state.setUserToken(userToken);\n      const contactMap = await ZOHO.CRM.API.getRecord({\n        Entity: entity,\n        RecordID: entityId\n      }).then(function (data) {\n        var _data$data, _data$data$, _settingSchema$zoho_w2, _data$data2, _data$data2$, _settingSchema$zoho_w3;\n\n        setRootFolderId(data === null || data === void 0 ? void 0 : (_data$data = data.data) === null || _data$data === void 0 ? void 0 : (_data$data$ = _data$data[0]) === null || _data$data$ === void 0 ? void 0 : _data$data$[settingSchema === null || settingSchema === void 0 ? void 0 : (_settingSchema$zoho_w2 = settingSchema.zoho_workdrive__crm_field_for_folder_id) === null || _settingSchema$zoho_w2 === void 0 ? void 0 : _settingSchema$zoho_w2.api_name]);\n        console.log({\n          data: data === null || data === void 0 ? void 0 : (_data$data2 = data.data) === null || _data$data2 === void 0 ? void 0 : (_data$data2$ = _data$data2[0]) === null || _data$data2$ === void 0 ? void 0 : _data$data2$[settingSchema === null || settingSchema === void 0 ? void 0 : (_settingSchema$zoho_w3 = settingSchema.zoho_workdrive__crm_field_for_folder_id) === null || _settingSchema$zoho_w3 === void 0 ? void 0 : _settingSchema$zoho_w3.api_name]\n        }); // state.setRootBread(rootTolderId);\n        // { name: folder?.attributes?.name, id: folder?.id }\n        // const folder = {\n        //   attributes:{\n        //     name: \"Something\"\n        //   },\n        //   id: rootTolderId\n        // }\n        // ApiCall.getFoldersItem(userToken, rootTolderId)\n        //   .then((res) => console.log({ myxRes: res }))\n        //   .catch((err) => {\n        //     console.log({ myxREs: err });\n        //   });\n        // let myUrl = `https://workdrive.zoho.com/api/v1/files/${rootTolderId}/files`;\n        // axios(myUrl, {\n        //   method: \"GET\",\n        //   headers: {\n        //     Accept: \"application/vnd.api+json\",\n        //     Authorization: `Bearer ${userToken}`,\n        //   },\n        // })\n        //   .then((response) => console.log(response))\n        //   .catch((error) => {\n        //     throw error;\n        //   });\n        // state.setBreadCrumbs(folder)\n\n        console.log({\n          bread: state.bread\n        });\n      });\n    }\n  }, [zohoLoaded, entity, entityId]); // React.useEffect(() => {\n  //   ApiCall.getAccessToken()\n  //     .then((res) => {\n  //       state.setToken(res.access_token);\n  //       state.setLoading(false);\n  //     })\n  //     .catch((error) => {\n  //       console.log(error);\n  //     });\n  // });\n\n  const customizer = {\n    direction: \"ltr\",\n    theme: \"PURPLE_THEME\",\n    activeMode: \"light\"\n  };\n  const theme = BuildTheme(customizer);\n  return /*#__PURE__*/_jsxDEV(Box, {\n    sx: {\n      width: \"100%\"\n    },\n    children: [/*#__PURE__*/_jsxDEV(Box, {\n      sx: {\n        borderBottom: 1,\n        borderColor: \"divider\"\n      },\n      children: /*#__PURE__*/_jsxDEV(Tabs, {\n        value: value,\n        onChange: handleChange,\n        \"aria-label\": \"basic tabs example\",\n        children: (_stateSettings$map = stateSettings.map((setting, index) => {\n          return /*#__PURE__*/_jsxDEV(Tab, {\n            label: setting === null || setting === void 0 ? void 0 : setting.Name,\n            ...a11yProps(index)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 207,\n            columnNumber: 20\n          }, this);\n        })) !== null && _stateSettings$map !== void 0 ? _stateSettings$map : {}\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 201,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 200,\n      columnNumber: 7\n    }, this), (_stateSettings$map2 = stateSettings.map((setting, index) => {\n      return /*#__PURE__*/_jsxDEV(TabPanel, {\n        value: value,\n        index: index,\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"App\",\n          children: [/*#__PURE__*/_jsxDEV(Response, {\n            rootFolderId: rootFolderId,\n            userAccessToken: userAccessToken\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 218,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Backdrop, {\n            sx: {\n              color: \"#fff\",\n              zIndex: theme => theme.zIndex.drawer + 1\n            },\n            open: state.loading,\n            children: /*#__PURE__*/_jsxDEV(CircularProgress, {\n              color: \"inherit\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 229,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 222,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 217,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 216,\n        columnNumber: 11\n      }, this);\n    })) !== null && _stateSettings$map2 !== void 0 ? _stateSettings$map2 : {}]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 199,\n    columnNumber: 5\n  }, this);\n};\n\n_s(App, \"guWF5FlzUsXlgBAumJzeiwmm3u0=\", false, function () {\n  return [useStyles, useTrackedStore];\n});\n\n_c = App;\nexport default App;\n\nvar _c;\n\n$RefreshReg$(_c, \"App\");","map":{"version":3,"sources":["D:/Rayhan/Unique Project/zoho_api_axios(1)/src/App.js"],"names":["React","useEffect","useState","BuildTheme","Response","makeStyles","Backdrop","CircularProgress","useTrackedStore","CryptoJS","ApiCall","axios","Tabs","Tab","PropTypes","Typography","Box","TabPanel","ZOHO","window","useStyles","grid","border","icon","fontSize","converConncectionMap","connMap","clientId","client_id","clientSecret","client_secret","authUrl","auth_url","refreshUrl","refresh_url","refreshToken","refresh_token","token_type","connName","conn_name","orgId","org_id","apiKey","api_key","a11yProps","index","id","App","classes","state","entity","setEntity","entityId","setEntityId","zohoLoaded","setZohoLoaded","rootFolderId","setRootFolderId","userAccessToken","setUserAccessToken","value","setValue","stateSettings","setStateSettings","handleChange","event","newValue","setUserDriveData","settings","userDriveData","data","forEach","setting","embeddedApp","on","console","log","Entity","EntityId","init","CRM","API","searchRecord","Type","Query","setting1","encSchema","zworkflows__Setting_Schema_Frontend","bytes","AES","decrypt","originalText","toString","enc","Utf8","settingSchema","JSON","parse","zoho_workdrive__crm_field_for_folder_id","api_name","connSchemaStr","zworkflows__Connection_Settings_Frontend","accessokenUrl","accessTokenMap","post","token","userToken","setToken","setUserToken","contactMap","getRecord","RecordID","then","bread","customizer","direction","theme","activeMode","width","borderBottom","borderColor","map","Name","color","zIndex","drawer","loading"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport \"react-perfect-scrollbar/dist/css/styles.css\";\r\nimport { BuildTheme } from \"./assets/global/Theme-variable\";\r\nimport Response from \"./components/Playground/Response\";\r\nimport \"./App.css\";\r\nimport { makeStyles } from \"@mui/styles\";\r\nimport Backdrop from \"@mui/material/Backdrop\";\r\nimport CircularProgress from \"@mui/material/CircularProgress\";\r\nimport useTrackedStore from \"./store/useTrackedStore\";\r\nimport CryptoJS from \"crypto-js\";\r\nimport * as ApiCall from \"./components/Playground/api/ApiCalling\";\r\nimport axios from \"axios\";\r\nimport Tabs from \"@mui/material/Tabs\";\r\nimport Tab from \"@mui/material/Tab\";\r\nimport PropTypes from \"prop-types\";\r\nimport Typography from \"@mui/material/Typography\";\r\nimport Box from \"@mui/material/Box\";\r\nimport TabPanel from \"./components/Playground/TabPanel\";\r\n\r\nconst ZOHO = window.ZOHO;\r\n\r\nconst useStyles = makeStyles({\r\n  grid: {\r\n    border: \"1px solid black\",\r\n  },\r\n  icon: {\r\n    fontSize: \"30px !important\",\r\n  },\r\n});\r\n\r\nfunction converConncectionMap(connMap) {\r\n  return {\r\n    clientId: connMap?.client_id,\r\n    clientSecret: connMap?.client_secret,\r\n    authUrl: connMap?.auth_url,\r\n    refreshUrl: connMap?.refresh_url,\r\n    refreshToken: connMap?.refresh_token,\r\n    token_type: connMap?.token_type,\r\n    connName: connMap?.conn_name,\r\n    orgId: connMap?.org_id,\r\n    apiKey: connMap?.api_key,\r\n  };\r\n}\r\n\r\nfunction a11yProps(index) {\r\n  return {\r\n    id: `simple-tab-${index}`,\r\n    \"aria-controls\": `simple-tabpanel-${index}`,\r\n  };\r\n}\r\n\r\nconst App = () => {\r\n  const classes = useStyles();\r\n  const state = useTrackedStore();\r\n  const [entity, setEntity] = useState(\"\");\r\n  const [entityId, setEntityId] = useState(\"\");\r\n  const [zohoLoaded, setZohoLoaded] = useState(false);\r\n  const [rootFolderId, setRootFolderId] = useState(null);\r\n  const [userAccessToken, setUserAccessToken] = useState(null);\r\n  const [value, setValue] = React.useState(0);\r\n  const [stateSettings, setStateSettings] = useState([]);\r\n\r\n  const handleChange = (event, newValue) => {\r\n    setValue(newValue);\r\n  };\r\n\r\n  const setUserDriveData = (settings) => {\r\n    let userDriveData = [];\r\n    settings?.data?.forEach(setting => {\r\n      \r\n    });\r\n  };\r\n\r\n  useEffect(() => {\r\n    /*\r\n     * Subscribe to the EmbeddedApp onPageLoad event before initializing\r\n     */\r\n\r\n    ZOHO.embeddedApp.on(\"PageLoad\", function (data) {\r\n      console.log(\"Module Data \", data);\r\n      setEntity(data?.Entity);\r\n      setEntityId(data?.EntityId);\r\n      setZohoLoaded(true);\r\n      //Custom Bussiness logic goes here\r\n    });\r\n\r\n    /*\r\n     * initializing the widget.\r\n     */\r\n    ZOHO.embeddedApp.init();\r\n  }, []);\r\n\r\n  useEffect(async () => {\r\n    if (zohoLoaded && entity !== \"\" && entityId !== \"\") {\r\n      const settings = await ZOHO.CRM.API.searchRecord({\r\n        Entity: \"zworkflows__ZWorkFlow_Settings\",\r\n        Type: \"criteria\",\r\n        Query:\r\n          \"(((zworkflows__Service_Type:equals:'ZOHO Workdrive') and (zworkflows__Settings_Type:equals:Addon)) and (zworkflows__Module_Name:equals:\" +\r\n          entity +\r\n          \" ))\",\r\n      });\r\n      console.log(\"settings\", settings?.data);\r\n      setStateSettings(settings?.data);\r\n      const setting1 = settings?.data?.[2];\r\n      const encSchema = setting1?.zworkflows__Setting_Schema_Frontend;\r\n      console.log({ encSchema }, entityId);\r\n      const bytes = CryptoJS.AES.decrypt(encSchema, setting1?.id);\r\n      console.log({ bytes });\r\n      var originalText = bytes.toString(CryptoJS.enc.Utf8);\r\n      const settingSchema = JSON.parse(originalText);\r\n      console.log({\r\n        settingSchema:\r\n          settingSchema?.zoho_workdrive__crm_field_for_folder_id?.api_name,\r\n      });\r\n      const connSchemaStr = CryptoJS.AES.decrypt(\r\n        settingSchema?.conn_name?.zworkflows__Connection_Settings_Frontend,\r\n        settingSchema?.conn_name?.id\r\n      ).toString(CryptoJS.enc.Utf8);\r\n      console.log(JSON.parse(connSchemaStr));\r\n      const connMap = JSON.parse(connSchemaStr);\r\n      console.log({ connMap });\r\n      const accessokenUrl =\r\n        \"https://instafunctions-695631012.development.catalystserverless.com/server/v1/auth/tokens/accesstoken\";\r\n\r\n      const accessTokenMap = await axios.post(\r\n        accessokenUrl,\r\n        converConncectionMap(connMap)\r\n      );\r\n      console.log({ accessTokenMap: accessTokenMap?.data?.data?.token });\r\n      const userToken = accessTokenMap?.data?.data?.token;\r\n      setUserAccessToken(accessTokenMap?.data?.data?.token);\r\n      state.setToken(accessTokenMap?.data?.data?.token);\r\n      state.setUserToken(userToken);\r\n      const contactMap = await ZOHO.CRM.API.getRecord({\r\n        Entity: entity,\r\n        RecordID: entityId,\r\n      }).then(function (data) {\r\n        setRootFolderId(\r\n          data?.data?.[0]?.[\r\n            settingSchema?.zoho_workdrive__crm_field_for_folder_id?.api_name\r\n          ]\r\n        );\r\n        console.log({\r\n          data: data?.data?.[0]?.[\r\n            settingSchema?.zoho_workdrive__crm_field_for_folder_id?.api_name\r\n          ],\r\n        });\r\n        // state.setRootBread(rootTolderId);\r\n        // { name: folder?.attributes?.name, id: folder?.id }\r\n        // const folder = {\r\n        //   attributes:{\r\n        //     name: \"Something\"\r\n        //   },\r\n        //   id: rootTolderId\r\n        // }\r\n        // ApiCall.getFoldersItem(userToken, rootTolderId)\r\n        //   .then((res) => console.log({ myxRes: res }))\r\n        //   .catch((err) => {\r\n        //     console.log({ myxREs: err });\r\n        //   });\r\n        // let myUrl = `https://workdrive.zoho.com/api/v1/files/${rootTolderId}/files`;\r\n        // axios(myUrl, {\r\n        //   method: \"GET\",\r\n        //   headers: {\r\n        //     Accept: \"application/vnd.api+json\",\r\n        //     Authorization: `Bearer ${userToken}`,\r\n        //   },\r\n        // })\r\n        //   .then((response) => console.log(response))\r\n        //   .catch((error) => {\r\n        //     throw error;\r\n        //   });\r\n        // state.setBreadCrumbs(folder)\r\n        console.log({ bread: state.bread });\r\n      });\r\n    }\r\n  }, [zohoLoaded, entity, entityId]);\r\n\r\n  // React.useEffect(() => {\r\n  //   ApiCall.getAccessToken()\r\n  //     .then((res) => {\r\n  //       state.setToken(res.access_token);\r\n  //       state.setLoading(false);\r\n  //     })\r\n  //     .catch((error) => {\r\n  //       console.log(error);\r\n  //     });\r\n  // });\r\n\r\n  const customizer = {\r\n    direction: \"ltr\",\r\n    theme: \"PURPLE_THEME\",\r\n    activeMode: \"light\",\r\n  };\r\n  const theme = BuildTheme(customizer);\r\n\r\n  return (\r\n    <Box sx={{ width: \"100%\" }}>\r\n      <Box sx={{ borderBottom: 1, borderColor: \"divider\" }}>\r\n        <Tabs\r\n          value={value}\r\n          onChange={handleChange}\r\n          aria-label=\"basic tabs example\"\r\n        >\r\n          {stateSettings.map((setting, index) => {\r\n            return <Tab label={setting?.Name} {...a11yProps(index)} />;\r\n          }) ?? {}}\r\n          {/* <Tab label=\"Item One X\" {...a11yProps(0)} />\r\n          <Tab label=\"Item Two\" {...a11yProps(1)} />\r\n          <Tab label=\"Item Three\" {...a11yProps(2)} /> */}\r\n        </Tabs>\r\n      </Box>\r\n      {stateSettings.map((setting, index) => {\r\n        return (\r\n          <TabPanel value={value} index={index}>\r\n            <div className=\"App\">\r\n              <Response\r\n                rootFolderId={rootFolderId}\r\n                userAccessToken={userAccessToken}\r\n              />\r\n              <Backdrop\r\n                sx={{\r\n                  color: \"#fff\",\r\n                  zIndex: (theme) => theme.zIndex.drawer + 1,\r\n                }}\r\n                open={state.loading}\r\n              >\r\n                <CircularProgress color=\"inherit\" />\r\n              </Backdrop>\r\n            </div>\r\n          </TabPanel>\r\n        );\r\n      }) ?? {}}\r\n      {/* <TabPanel value={value} index={0}>\r\n        <div className=\"App\">\r\n          <Response\r\n            rootFolderId={rootFolderId}\r\n            userAccessToken={userAccessToken}\r\n          />\r\n          <Backdrop\r\n            sx={{ color: \"#fff\", zIndex: (theme) => theme.zIndex.drawer + 1 }}\r\n            open={state.loading}\r\n          >\r\n            <CircularProgress color=\"inherit\" />\r\n          </Backdrop>\r\n        </div>\r\n      </TabPanel>\r\n      <TabPanel value={value} index={1}>\r\n        Item Two\r\n      </TabPanel>\r\n      <TabPanel value={value} index={2}>\r\n        Item Three\r\n      </TabPanel> */}\r\n    </Box>\r\n  );\r\n};\r\n\r\nexport default App;\r\n"]},"metadata":{},"sourceType":"module"}